<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¨ë§ˆìŒ ì„±ì¥ì¼ê¸° Â· í•™ìƒìš© MVP</title>
  <style>
    * { box-sizing: border-box; }
    :root { --bg:#fafafc; --card:#fff; --ink:#111; --muted:#6b7280; --accent:#2563eb; --ring:rgba(37,99,235,.25); --line:#e5e7eb; }
    body{ margin:0; font-family:system-ui,-apple-system,"Noto Sans KR",Segoe UI,Roboto,Helvetica,Arial; background:var(--bg); color:var(--ink); }
    header{ position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#fff 0%,rgba(255,255,255,.9) 60%,transparent);backdrop-filter:blur(8px);}
    .container{max-width:1200px;margin:0 auto;padding:16px;}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,.05);}
    .section{padding:16px;}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .field{display:grid;gap:6px;flex:1;min-width:120px;}
    label{font-size:12px;color:var(--muted);}
    input,select,textarea,button{font:inherit;}
    input,select,textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 4px var(--ring);}
    button{padding:10px 14px;border-radius:10px;border:1px solid #d1d5db;background:#fff;cursor:pointer;}
    .btn{background:var(--accent);color:#fff;border-color:var(--accent);}
    .btn:disabled{opacity:.6;cursor:not-allowed;}
    .kicker{color:var(--muted);font-size:12px;}
    .divider{height:1px;background:var(--line);margin:12px 0;}
  </style>

  <!-- âœ… Firebase SDK (ëª¨ë“ˆ ë°©ì‹) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

    // ğŸ”¹ Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyCUvpi0A0Olc9t4Aamo6jCL5ZeKSppPmVM",
      authDomain: "haru-dc490.firebaseapp.com",
      databaseURL: "https://haru-dc490-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "haru-dc490",
      storageBucket: "haru-dc490.appspot.com",
      messagingSenderId: "1062975092523",
      appId: "1:1062975092523:web:3750d0e5722cae7767b76e",
      measurementId: "G-6VVS4MSJBT"
    };

    // ğŸ”¹ ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    console.log("âœ… Firebase initialized:", app.name);

    // ì „ì—­ ê³µìœ 
    window.auth = auth;
    window.db = db;
  </script>
</head>

<body>
  <header>
    <div class="container">
      <div class="brand">
        <h1>ì˜¨ë§ˆìŒ ì„±ì¥ì¼ê¸° Â· í•™ìƒìš© MVP</h1>
        <span class="kicker">íŠ¹ë³„í•œ í•˜ë£¨ Ã— SEL 5-Years Diary</span>
      </div>
    </div>
  </header>

  <!-- ë¡œê·¸ì¸ í™”ë©´ -->
  <section id="authView" class="container" style="max-width:560px;">
    <div class="card section">
      <div class="kicker">ê³„ì • ë¡œê·¸ì¸</div>
      <div class="row">
        <div class="field"><label>ì•„ì´ë””</label><input id="userid" placeholder="ì˜ˆ: s1234"></div>
        <div class="field"><label>ë¹„ë°€ë²ˆí˜¸</label><input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸"></div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button id="btnLogin" class="btn">ë¡œê·¸ì¸</button>
        <button id="btnSignup">íšŒì›ê°€ì…</button>
      </div>
      <p class="kicker">GitHub Pages í…ŒìŠ¤íŠ¸ìš© â€” Firebase Auth ì—°ë™</p>
    </div>
  </section>

  <!-- ë©”ì¸ í™”ë©´ -->
  <section id="mainView" class="container" style="display:none;">
    <div class="card section">
      <h3>ë¡œê·¸ì¸ ì„±ê³µ ğŸ‰</h3>
      <p>ì´ì œ Firebase ì—°ê²°ì´ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤!</p>
      <button id="btnLogout" class="btn">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </section>

  <!-- ë™ì‘ ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    const $ = (id) => document.getElementById(id);
    const authView = $('authView'), mainView = $('mainView');
    const uidEl = $('userid'), pwEl = $('password');
    const btnLogin = $('btnLogin'), btnSignup = $('btnSignup'), btnLogout = $('btnLogout');

    // ë¡œê·¸ì¸ ìƒíƒœ ê´€ë¦¬
    function syncUI(user) {
      const loggedIn = !!user;
      authView.style.display = loggedIn ? 'none' : 'block';
      mainView.style.display = loggedIn ? 'block' : 'none';
    }

    // íšŒì›ê°€ì…
    btnSignup.addEventListener('click', async () => {
      const uid = uidEl.value.trim(), pw = pwEl.value;
      if (!uid || !pw) return alert('ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
      try {
        const email = `${uid}@id.onmaum`;
        const userCredential = await window.auth.createUserWithEmailAndPassword
          ? window.auth.createUserWithEmailAndPassword(email, pw)
          : (await import('https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js')).createUserWithEmailAndPassword(window.auth, email, pw);
        alert('íšŒì›ê°€ì… ì„±ê³µ!');
        syncUI(userCredential.user);
      } catch (e) {
        console.error(e);
        alert('íšŒì›ê°€ì… ì‹¤íŒ¨: ' + e.message);
      }
    });

    // ë¡œê·¸ì¸
    btnLogin.addEventListener('click', async () => {
      const uid = uidEl.value.trim(), pw = pwEl.value;
      if (!uid || !pw) return alert('ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
      try {
        const email = `${uid}@id.onmaum`;
        const userCredential = await window.auth.signInWithEmailAndPassword
          ? window.auth.signInWithEmailAndPassword(email, pw)
          : (await import('https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js')).signInWithEmailAndPassword(window.auth, email, pw);
        alert('ë¡œê·¸ì¸ ì„±ê³µ!');
        syncUI(userCredential.user);
      } catch (e) {
        console.error(e);
        alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + e.message);
      }
    });

    // ë¡œê·¸ì•„ì›ƒ
    btnLogout.addEventListener('click', async () => {
      try {
        const { signOut } = await import('https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js');
        await signOut(window.auth);
        alert('ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
        syncUI(null);
      } catch (e) {
        console.error(e);
      }
    });
  </script>
</body>
</html>
